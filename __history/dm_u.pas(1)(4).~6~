unit dm_u;

interface

uses
  System.SysUtils, System.Classes, db, adodb;

type
  Tdm = class(TDataModule)
    procedure DataModuleCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  dm: Tdm;
  conPAT: TADOConnection;

  { STAP 1 DECLARE }

  // Delphi code  verklaar
  { Copy en pase vir jou tables en rename }
  tbTable: TADOTable;
  dscTable: TDataSource;

  { Copy en pase vir jou eie queries en rename }

  // SQL Verklaar
  qry: TADOQuery;
  dscQry: TDataSource;

  { Voorbeeld ------- Verdwyder hierdie code voor jy dit inhandig }
  tbStudents: TADOTable;
  dscStudents: TADOTable;

implementation

{%CLASSGROUP 'Vcl.Controls.TControl'}
{$R *.dfm}

procedure Tdm.DataModuleCreate(Sender: TObject);
begin
  { STAP TWEE CREATE }
  conPAT := TADOConnection.Create(dm);

  {TABELLE VERVANG MET JOU EIE KODE}
  tbTable := TADOTable.Create(dm);
  dscTable := TDataSource.Create(dm);

  {QRY VERVANG MET JOU EIE KODE}

  qry := TADOQuery.Create(dm);
  dscQry := TDataSource.Create(dm);



  { STAP 3 Manipulate }


  conPAT.ConnectionString := 'Provider=Microsoft.Jet.OLEDB.4.0;Data Source=' +
    ExtractFilePath(ParamStr(0)) + 'PAT.mdb' + '; Persist Security Info=False';
  conPAT.LoginPrompt := False;     //mdb Access 2000

  conPAT.Open;

  // Copy en Paste vir elke tabel. Verander Tabel na jou tabel naam }
  tbTable.Active := False;
  tbTable.Connection := conPAT;
  tbTable.TableName := 'tblContact'; // Jou tabel naam in databasis
  tbTable.Active := true;
  tbTable.Open;
  dscTable.DataSet := tbTable;

  //Copy en paste oral in jou pat!!!!!!!!!!!!

  qry.SQL.Clear;
  qry.SQL.Text := 'Select * from tblMembers';
  qry.ExecSQL;
  qry.open;




end;

end.
